{% extends "base_generic.html" %}

{% block menubar %}
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/styles.css' %}" />
  

 
<br>


 <script>
function goBack() {
    window.history.back();
}
</script>
{% endblock %}


{% block other%}
<br>
<a align="center" style="color:red;">{{mess}}</a>

{% endblock %}
<br>

{% block content %}

<br>


<HorizontalPanel>
<input type="button" name="Go_Back"  onclick="goBack();"  id="Go_Back" class="button4" value="Go Back" >
&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;
<span id="project_name" class="textstyle4" >{{project_name}} </span>
&nbsp; &nbsp;&nbsp;
<span id="time_left" class="textstyle4" >Time Left : </span>
&nbsp;&nbsp; 
<span id="demo" class="textstyle4" ></span>


</HorizontalPanel>


<script type="text/javascript">   
    $( document ).ready(function() {
       setInterval(function(){
            $.getJSON("{% url 'update' %}",
                    function (data) {
                        var json = data['latest_results_list'];
                        var tr;
                         $('#myTable tbody').html("");
                        for (var i = 0; i < json.length; i++) {
                            tr = $('<tr/>');
                            tr.append("<td>" + json[i].step_number + "</td>");
                            tr.append("<td>" + json[i].name + "</td>");
                            tr.append("<td>" + json[i].description + "</td>");
                            tr.append("<td>" + json[i].state + "</td>");
                            tr.append("<td>" + json[i].progress + " % </td>");
                             $('#myTable tbody').append(tr);

                        }
                    });
       },5000);
    });
</script>


<script>
// Set the date we're counting down to
var countDownDate = new Date("Sep 5, 2018 15:37:25").getTime();

// Update the count down every 1 second
var x = setInterval(function() {

  // Get todays date and time
  var now = new Date().getTime();

  // Find the distance between now an the count down date
  var distance = countDownDate - now;

  // Time calculations for days, hours, minutes and seconds
  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  var seconds = Math.floor((distance % (1000 * 60)) / 1000);

  // Display the result in the element with id="demo"
  document.getElementById("demo").innerHTML = days + "d " + hours + "h "
  + minutes + "m " + seconds + "s ";

  // If the count down is finished, write some text 
  if (distance < 0) {
    clearInterval(x);
    document.getElementById("demo").innerHTML = "EXPIRED";
  }
}, 1000);
</script>

<table class='responstable' id ='myTable'>
    <thead>
    <tr>
      <th>Step Number</th>
      <th>Name</th>
      <th>Description</th>
      <th>State</th>
      <th>Progress</th>
    </tr>
    </thead>
    <tbody >
         {% for b in latest_results_list %}
             <tr>
             <td>{{ b.step_number }}</td>
             <td>{{ b.name }}</td>
             <td>{{ b.description }}</td>
             <td>{{ b.state }}</td>
             <td>{{ b.progress }} % </td>
             </tr>                 
         {% endfor %}
    </tbody >        
</table>



{% endblock %}